Ivy Default Cache set to: /Users/raghavathyagaraj/.ivy2/cache
The jars for the packages stored in: /Users/raghavathyagaraj/.ivy2/jars
org.apache.spark#spark-sql-kafka-0-10_2.12 added as a dependency
io.delta#delta-spark_2.12 added as a dependency
:: resolving dependencies :: org.apache.spark#spark-submit-parent-242e087b-78fc-45bf-9d2f-14452b92cb34;1.0
	confs: [default]
	found org.apache.spark#spark-sql-kafka-0-10_2.12;3.5.3 in central
	found org.apache.spark#spark-token-provider-kafka-0-10_2.12;3.5.3 in central
	found org.apache.kafka#kafka-clients;3.4.1 in central
	found org.lz4#lz4-java;1.8.0 in central
	found org.xerial.snappy#snappy-java;1.1.10.5 in central
	found org.slf4j#slf4j-api;2.0.7 in central
	found org.apache.hadoop#hadoop-client-runtime;3.3.4 in central
	found org.apache.hadoop#hadoop-client-api;3.3.4 in central
	found commons-logging#commons-logging;1.1.3 in central
	found com.google.code.findbugs#jsr305;3.0.0 in central
	found org.apache.commons#commons-pool2;2.11.1 in central
	found io.delta#delta-spark_2.12;3.3.0 in central
	found io.delta#delta-storage;3.3.0 in central
	found org.antlr#antlr4-runtime;4.9.3 in central
:: resolution report :: resolve 335ms :: artifacts dl 13ms
	:: modules in use:
	com.google.code.findbugs#jsr305;3.0.0 from central in [default]
	commons-logging#commons-logging;1.1.3 from central in [default]
	io.delta#delta-spark_2.12;3.3.0 from central in [default]
	io.delta#delta-storage;3.3.0 from central in [default]
	org.antlr#antlr4-runtime;4.9.3 from central in [default]
	org.apache.commons#commons-pool2;2.11.1 from central in [default]
	org.apache.hadoop#hadoop-client-api;3.3.4 from central in [default]
	org.apache.hadoop#hadoop-client-runtime;3.3.4 from central in [default]
	org.apache.kafka#kafka-clients;3.4.1 from central in [default]
	org.apache.spark#spark-sql-kafka-0-10_2.12;3.5.3 from central in [default]
	org.apache.spark#spark-token-provider-kafka-0-10_2.12;3.5.3 from central in [default]
	org.lz4#lz4-java;1.8.0 from central in [default]
	org.slf4j#slf4j-api;2.0.7 from central in [default]
	org.xerial.snappy#snappy-java;1.1.10.5 from central in [default]
	---------------------------------------------------------------------
	|                  |            modules            ||   artifacts   |
	|       conf       | number| search|dwnlded|evicted|| number|dwnlded|
	---------------------------------------------------------------------
	|      default     |   14  |   0   |   0   |   0   ||   14  |   0   |
	---------------------------------------------------------------------
:: retrieving :: org.apache.spark#spark-submit-parent-242e087b-78fc-45bf-9d2f-14452b92cb34
	confs: [default]
	0 artifacts copied, 14 already retrieved (0kB/9ms)
26/01/01 18:09:21 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
26/01/01 18:09:21 WARN Utils: Service 'SparkUI' could not bind on port 4040. Attempting port 4041.
26/01/01 18:09:21 WARN Utils: Service 'SparkUI' could not bind on port 4041. Attempting port 4042.
2026-01-01 18:09:22 - GoldLayerJob - INFO - Reading Silver Data from: /Users/raghavathyagaraj/crypto-lakehouse/data/delta/silver
2026-01-01 18:09:24 - GoldLayerJob - INFO - Starting Gold Stream...
26/01/01 18:09:24 WARN ResolveWriteToStream: spark.sql.adaptive.enabled is not supported in streaming DataFrames/Datasets and will be disabled.
2026-01-01 18:09:25 - GoldLayerJob - INFO - âœ… Gold Stream Running! Writing to /Users/raghavathyagaraj/crypto-lakehouse/data/delta/gold
26/01/01 18:09:29 WARN SparkStringUtils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.sql.debug.maxToStringFields'.
[Stage 0:>                                                          (0 + 1) / 1][Stage 1:>                                                         (0 + 8) / 50][Stage 1:>                                                        (0 + 13) / 50][Stage 1:=================>                                       (15 + 8) / 50][Stage 1:============================>                            (25 + 8) / 50][Stage 1:=========================================>               (36 + 8) / 50]                                                                                26/01/01 18:09:34 WARN HDFSBackedStateStoreProvider: The state for version 61 doesn't exist in loadedMaps. Reading snapshot file and delta files if needed...Note that this is normal for the first batch of starting query.
26/01/01 18:09:34 WARN HDFSBackedStateStoreProvider: The state for version 61 doesn't exist in loadedMaps. Reading snapshot file and delta files if needed...Note that this is normal for the first batch of starting query.
26/01/01 18:09:34 WARN HDFSBackedStateStoreProvider: The state for version 61 doesn't exist in loadedMaps. Reading snapshot file and delta files if needed...Note that this is normal for the first batch of starting query.
26/01/01 18:09:34 WARN HDFSBackedStateStoreProvider: The state for version 61 doesn't exist in loadedMaps. Reading snapshot file and delta files if needed...Note that this is normal for the first batch of starting query.
[Stage 6:>                                                         (0 + 8) / 50][Stage 6:===============>                                         (14 + 9) / 50][Stage 6:===============================>                         (28 + 8) / 50][Stage 6:==========================================>              (37 + 8) / 50]                                                                                [Stage 22:===============================================>        (42 + 8) / 50]                                                                                [Stage 24:>                                                         (0 + 1) / 1][Stage 25:>                                                         (0 + 4) / 4]                                                                                [Stage 27:===========>                                            (10 + 8) / 50][Stage 27:================>                                       (15 + 8) / 50]                                                                                [Stage 29:==========================================>             (38 + 8) / 50]                                                                                [Stage 42:=========>                                               (8 + 8) / 50][Stage 42:=============>                                          (12 + 8) / 50][Stage 42:=====================>                                  (19 + 8) / 50][Stage 42:===============================>                        (28 + 8) / 50]                                                                                [Stage 49:=========>                                               (8 + 8) / 50][Stage 49:=================>                                      (16 + 8) / 50][Stage 49:============================>                           (25 + 8) / 50][Stage 49:===========================================>            (39 + 8) / 50]                                                                                [Stage 58:=============================================>          (41 + 8) / 50]                                                                                [Stage 63:=============================>                          (26 + 8) / 50][Stage 63:====================================================>   (47 + 3) / 50]                                                                                [Stage 78:====================================================>   (47 + 3) / 50]                                                                                [Stage 85:========================================>               (36 + 8) / 50][Stage 85:=====================================================>  (48 + 2) / 50]                                                                                [Stage 90:===================>                                    (17 + 8) / 50][Stage 90:==================================>                     (31 + 8) / 50][Stage 90:==========================================>             (38 + 9) / 50]                                                                                [Stage 92:===========================================>            (39 + 9) / 50]                                                                                [Stage 99:===============================>                       (29 + 11) / 50][Stage 99:=====================================================>  (48 + 2) / 50]                                                                                [Stage 104:===================================================>   (47 + 3) / 50]                                                                                [Stage 106:=======================================================(50 + 0) / 50]                                                                                [Stage 111:=======================>                               (21 + 8) / 50][Stage 111:=============================>                         (27 + 9) / 50][Stage 111:=====================================>                 (34 + 8) / 50][Stage 111:=================================================>     (45 + 5) / 50]                                                                                [Stage 118:==========================>                            (24 + 8) / 50][Stage 118:====================================>                  (33 + 8) / 50][Stage 118:=====================================================> (49 + 1) / 50]                                                                                [Stage 132:============================>                          (26 + 8) / 50][Stage 132:====================================>                  (33 + 8) / 50][Stage 132:=========================================>             (38 + 8) / 50][Stage 132:================================================>      (44 + 6) / 50][Stage 132:====================================================>  (48 + 2) / 50]                                                                                [Stage 134:==================================>                    (31 + 8) / 50]                                                                                [Stage 181:=================>                                     (16 + 8) / 50][Stage 181:==========================>                            (24 + 8) / 50]                                                                                [Stage 188:====================>                                  (19 + 8) / 50][Stage 188:=================================================>     (45 + 5) / 50][Stage 188:=====================================================> (49 + 1) / 50]                                                                                [Stage 193:>                                                        (0 + 4) / 4]                                                                                [Stage 200:==========================================>              (3 + 1) / 4]                                                                                [Stage 207:==========================================>              (3 + 1) / 4]                                                                                [Stage 216:======================>                                (20 + 8) / 50][Stage 216:=============================================>         (41 + 8) / 50]                                                                                [Stage 231:========>                                               (8 + 8) / 50][Stage 231:=================>                                     (16 + 8) / 50][Stage 231:==========================>                            (24 + 8) / 50][Stage 231:====================================>                  (33 + 8) / 50][Stage 231:================================================>      (44 + 6) / 50]                                                                                [Stage 236:===============================>                       (29 + 8) / 50]                                                                                [Stage 243:===============>                                       (14 + 8) / 50][Stage 243:===============================>                       (29 + 8) / 50]                                                                                [Stage 257:=======================>                               (21 + 8) / 50]                                                                                [Stage 264:>                                                       (0 + 8) / 50][Stage 264:========>                                               (8 + 8) / 50][Stage 264:==============>                                        (13 + 8) / 50][Stage 264:=================>                                     (16 + 8) / 50][Stage 264:==============================>                        (28 + 8) / 50]                                                                                [Stage 271:======================>                                (20 + 8) / 50][Stage 271:==================================>                    (31 + 8) / 50][Stage 271:========================================>              (37 + 8) / 50][Stage 271:============================================>          (40 + 8) / 50]                                                                                [Stage 285:========>                                               (8 + 9) / 50]                                                                                [Stage 292:=============>                                         (12 + 8) / 50][Stage 292:=================>                                     (16 + 8) / 50][Stage 292:==========================>                            (24 + 8) / 50][Stage 292:===================================>                   (32 + 8) / 50][Stage 292:======================================>                (35 + 8) / 50]                                                                                [Stage 294:=======================>                               (21 + 8) / 50][Stage 294:=====================================================> (49 + 1) / 50]                                                                                [Stage 297:>                                                        (0 + 4) / 4]                                                                                [Stage 299:>                                                       (0 + 8) / 50][Stage 299:===================>                                   (18 + 8) / 50]                                                                                [Stage 301:>                                                       (0 + 8) / 50][Stage 301:=================>                                     (16 + 8) / 50][Stage 301:=======================================>               (36 + 8) / 50]                                                                                [Stage 307:================>                                      (15 + 8) / 50][Stage 307:===============================>                       (29 + 8) / 50]                                                                                [Stage 312:===============>                                       (14 + 8) / 50][Stage 312:=================>                                     (16 + 8) / 50][Stage 312:===============================>                       (29 + 8) / 50][Stage 312:===================================>                   (32 + 8) / 50]                                                                                [Stage 314:============================================>          (40 + 8) / 50]                                                                                [Stage 316:>                                                        (0 + 1) / 1]                                                                                [Stage 319:=============>                                         (12 + 8) / 50][Stage 319:=================================>                     (30 + 8) / 50]                                                                                [Stage 345:>                                                        (0 + 4) / 4][Stage 345:==========================================>              (3 + 1) / 4]                                                                                [Stage 347:==============================>                        (28 + 8) / 50][Stage 347:==================================================>    (46 + 4) / 50][Stage 347:=====================================================> (49 + 1) / 50]                                                                                [Stage 351:>                                                        (0 + 1) / 1][Stage 352:>                                                        (0 + 4) / 4][Stage 352:============================>                            (2 + 2) / 4][Stage 352:==========================================>              (3 + 1) / 4]                                                                                [Stage 356:================>                                      (15 + 8) / 50][Stage 356:=========================================>             (38 + 8) / 50]                                                                                [Stage 368:===================================>                   (32 + 8) / 50]                                                                                [Stage 382:>                                                        (0 + 1) / 1][Stage 383:>                                                       (0 + 8) / 50][Stage 383:========>                                               (8 + 8) / 50][Stage 383:=================>                                     (16 + 8) / 50][Stage 383:==========================>                            (24 + 8) / 50][Stage 383:=========================================>             (38 + 8) / 50]                                                                                [Stage 392:>                                                        (0 + 1) / 1]                                                                                [Stage 395:=======================================================(50 + 0) / 50]                                                                                [Stage 397:=========================================>             (38 + 8) / 50]                                                                                [Stage 402:=======================================>               (36 + 8) / 50]                                                                                [Stage 404:=============================>                         (27 + 8) / 50]                                                                                [Stage 409:==============>                                        (13 + 8) / 50][Stage 409:===================>                                   (18 + 8) / 50][Stage 409:=========================>                             (23 + 8) / 50][Stage 409:=================================>                     (30 + 8) / 50][Stage 409:===================================>                   (32 + 8) / 50][Stage 409:========================================>              (37 + 8) / 50][Stage 409:==========================================>            (39 + 8) / 50][Stage 409:===================================================>   (47 + 3) / 50]                                                                                [Stage 411:=====================================>                 (34 + 8) / 50]                                                                                [Stage 416:========>                                               (8 + 8) / 50][Stage 416:=============>                                         (12 + 9) / 50][Stage 416:==========================>                            (24 + 8) / 50]                                                                                [Stage 418:=======================================>               (36 + 8) / 50]                                                                                [Stage 420:>                                                        (0 + 1) / 1][Stage 421:>                                                        (0 + 4) / 4]                                                                                [Stage 422:>                                                        (0 + 7) / 7][Stage 422:================================================>        (6 + 1) / 7][Stage 423:>                                                       (0 + 8) / 50][Stage 423:=================>                                    (16 + 10) / 50][Stage 423:==========================>                            (24 + 8) / 50]                                                                                [Stage 429:>                                                        (0 + 4) / 4]                                                                                [Stage 430:>                                                        (0 + 8) / 8]                                                                                [Stage 437:>                                                        (0 + 5) / 9][Stage 437:>                                                        (0 + 8) / 9][Stage 437:============================================>            (7 + 2) / 9][Stage 438:>                                                       (0 + 8) / 50][Stage 438:========================>                              (22 + 8) / 50]                                                                                [Stage 451:===============================================>         (5 + 1) / 6][Stage 452:==================================>                    (31 + 8) / 50]                                                                                [Stage 458:>                                                        (0 + 1) / 1]                                                                                [Stage 460:===========================>                           (25 + 8) / 50][Stage 460:===============================>                       (29 + 8) / 50][Stage 460:=================================>                     (30 + 8) / 50][Stage 460:==================================================>    (46 + 4) / 50]                                                                                [Stage 465:=================>                                     (16 + 8) / 50][Stage 465:======================>                                (20 + 8) / 50][Stage 465:==========================>                            (24 + 8) / 50][Stage 465:=============================================>         (41 + 8) / 50]                                                                                [Stage 470:>                                                        (0 + 4) / 4][Stage 470:============================>                            (2 + 2) / 4][Stage 470:==========================================>              (3 + 1) / 4]                                                                                [Stage 472:=================>                                     (16 + 8) / 50][Stage 472:==================>                                    (17 + 8) / 50][Stage 472:==========================>                            (24 + 8) / 50][Stage 472:===========================>                           (25 + 8) / 50][Stage 472:=================================================>     (45 + 5) / 50]                                                                                [Stage 474:=====================================>                 (34 + 9) / 50][Stage 474:==============================================>        (42 + 8) / 50]                                                                                [Stage 477:==============>                                          (1 + 3) / 4]                                                                                [Stage 479:===================================>                   (32 + 8) / 50][Stage 479:============================================>          (40 + 8) / 50][Stage 479:==================================================>    (46 + 4) / 50]                                                                                [Stage 481:==================================>                    (31 + 8) / 50][Stage 481:===================================>                   (32 + 8) / 50]                                                                                [Stage 483:>                                                        (0 + 1) / 1][Stage 484:>                                                        (0 + 4) / 4]                                                                                [Stage 486:========>                                               (8 + 8) / 50][Stage 486:==========>                                             (9 + 9) / 50][Stage 486:===========>                                           (10 + 9) / 50][Stage 486:==============>                                        (13 + 8) / 50][Stage 486:=================>                                     (16 + 8) / 50][Stage 486:======================>                                (20 + 8) / 50][Stage 486:==========================>                            (24 + 8) / 50][Stage 486:==========================================>            (39 + 8) / 50][Stage 486:===================================================>   (47 + 3) / 50]                                                                                [Stage 488:>                                                       (0 + 8) / 50][Stage 488:==============>                                       (13 + 10) / 50][Stage 488:=====================================>                (35 + 10) / 50]                                                                                [Stage 493:========>                                               (8 + 8) / 50][Stage 493:=================>                                     (16 + 8) / 50][Stage 493:=================>                                     (16 + 9) / 50][Stage 493:==========================>                            (24 + 8) / 50][Stage 493:===========================>                           (25 + 8) / 50][Stage 493:===================================>                   (32 + 8) / 50][Stage 493:=====================================>                 (34 + 8) / 50][Stage 493:=======================================>               (36 + 8) / 50][Stage 493:==========================================>            (39 + 8) / 50][Stage 493:============================================>          (40 + 8) / 50][Stage 493:=============================================>         (41 + 8) / 50][Stage 493:====================================================>  (48 + 2) / 50][Stage 493:=======================================================(50 + 0) / 50]                                                                                [Stage 495:============================================>          (40 + 8) / 50]                                                                                [Stage 500:=================>                                     (16 + 8) / 50][Stage 500:==================================>                    (31 + 8) / 50]                                                                                [Stage 502:===================================================>   (47 + 3) / 50]                                                                                [Stage 507:==========================>                            (24 + 8) / 50][Stage 507:==================================>                    (31 + 8) / 50][Stage 507:============================================>          (40 + 8) / 50][Stage 507:====================================================>  (48 + 2) / 50]                                                                                [Stage 509:=================>                                     (16 + 8) / 50][Stage 509:=================================>                     (30 + 8) / 50][Stage 509:=================================================>     (45 + 5) / 50][Stage 510:>                                                        (0 + 1) / 1]                                                                                [Stage 514:=================>                                     (16 + 8) / 50][Stage 514:==========================>                            (24 + 8) / 50][Stage 514:==================================>                    (31 + 8) / 50][Stage 514:===================================>                   (32 + 9) / 50][Stage 514:============================================>          (40 + 8) / 50][Stage 514:===============================================>       (43 + 7) / 50]                                                                                [Stage 516:>                                                       (0 + 8) / 50][Stage 516:==================>                                    (17 + 8) / 50][Stage 516:=======================================>               (36 + 8) / 50]                                                                                [Stage 520:>                                                        (0 + 6) / 6][Stage 521:>                                                       (0 + 8) / 50][Stage 521:========>                                               (8 + 8) / 50][Stage 521:=================>                                     (16 + 8) / 50][Stage 521:==========================>                            (24 + 8) / 50][Stage 521:===================================>                   (32 + 8) / 50]                                                                                [Stage 527:>                                                        (0 + 6) / 6][Stage 528:========>                                               (8 + 8) / 50][Stage 528:==============>                                        (13 + 8) / 50][Stage 528:==================>                                    (17 + 8) / 50][Stage 528:=======================>                               (21 + 8) / 50][Stage 528:========================>                              (22 + 8) / 50][Stage 528:===============================>                       (29 + 8) / 50][Stage 528:========================================>              (37 + 8) / 50][Stage 528:============================================>          (40 + 8) / 50][Stage 528:====================================================>  (48 + 2) / 50]                                                                                [Stage 530:====================================================>  (48 + 2) / 50]                                                                                [Stage 536:=================>                                     (16 + 8) / 50][Stage 536:==================================>                    (31 + 8) / 50]                                                                                [Stage 539:>                                                        (0 + 4) / 4][Stage 539:==========================================>              (3 + 1) / 4]                                                                                [Stage 540:>                                                        (0 + 2) / 2][Stage 541:=============>                                         (12 + 8) / 50][Stage 541:=========================>                             (23 + 8) / 50][Stage 541:====================================>                  (33 + 8) / 50][Stage 541:=============================================>         (41 + 8) / 50]                                                                                [Stage 548:========>                                               (8 + 8) / 50][Stage 548:=================>                                     (16 + 8) / 50][Stage 548:======================>                                (20 + 8) / 50][Stage 548:=========================>                             (23 + 8) / 50][Stage 548:==========================>                            (24 + 8) / 50][Stage 548:===================================>                   (32 + 8) / 50]                                                                                [Stage 553:==========================================>              (3 + 1) / 4]                                                                                [Stage 555:=================>                                     (16 + 8) / 50][Stage 555:=====================================>                 (34 + 8) / 50][Stage 555:============================================>          (40 + 8) / 50]                                                                                [Stage 562:================>                                      (15 + 8) / 50][Stage 562:==============================>                        (28 + 8) / 50][Stage 562:=================================>                     (30 + 8) / 50][Stage 562:==============================================>        (42 + 8) / 50]                                                                                [Stage 567:>                                                        (0 + 4) / 4]                                                                                [Stage 569:========>                                               (8 + 8) / 50][Stage 569:================>                                      (15 + 9) / 50][Stage 569:===========================>                           (25 + 8) / 50][Stage 569:==============================>                        (28 + 8) / 50][Stage 569:====================================>                  (33 + 8) / 50][Stage 569:==========================================>            (39 + 8) / 50][Stage 569:=================================================>     (45 + 5) / 50]                                                                                [Stage 573:>                                                        (0 + 2) / 2][Stage 574:>                                                        (0 + 4) / 4][Stage 574:============================>                            (2 + 2) / 4][Stage 574:==========================================>              (3 + 1) / 4]                                                                                [Stage 576:=================>                                     (16 + 9) / 50][Stage 576:========================================>              (37 + 8) / 50]                                                                                [Stage 581:>                                                        (0 + 4) / 4][Stage 581:==========================================>              (3 + 1) / 4]                                                                                [Stage 590:==============================================>        (42 + 8) / 50]                                                                                [Stage 604:>                                                       (0 + 8) / 50][Stage 604:========>                                               (8 + 8) / 50][Stage 604:========================>                              (22 + 8) / 50][Stage 604:=============================>                         (27 + 8) / 50][Stage 604:====================================>                  (33 + 8) / 50]                                                                                [Stage 606:>                                                       (0 + 8) / 50][Stage 606:>                                                      (0 + 16) / 50][Stage 606:==========================>                            (24 + 8) / 50]                                                                                [Stage 612:===========>                                           (10 + 8) / 50][Stage 612:===========================>                           (25 + 8) / 50][Stage 612:=============================================>         (41 + 8) / 50]                                                                                [Stage 614:>                                                        (0 + 1) / 1][Stage 615:>                                                        (0 + 4) / 4][Stage 615:==========================================>              (3 + 1) / 4]                                                                                [Stage 624:>                                                       (0 + 8) / 50][Stage 624:========>                                               (8 + 8) / 50][Stage 624:=================>                                     (16 + 8) / 50][Stage 624:==========================>                            (24 + 8) / 50][Stage 624:=====================================================> (49 + 1) / 50]                                                                                [Stage 629:==========================================>              (3 + 1) / 4]26/01/01 18:19:06 ERROR DeltaFileFormatWriter: Aborting job fd795096-ac59-463c-acd6-63e9dd897ec9
org.apache.spark.SparkException: Job 266 cancelled because SparkContext was shut down
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$cleanUpAfterSchedulerStop$1(DAGScheduler.scala:1253)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$cleanUpAfterSchedulerStop$1$adapted(DAGScheduler.scala:1251)
	at scala.collection.mutable.HashSet.foreach(HashSet.scala:79)
	at org.apache.spark.scheduler.DAGScheduler.cleanUpAfterSchedulerStop(DAGScheduler.scala:1251)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onStop(DAGScheduler.scala:3087)
	at org.apache.spark.util.EventLoop.stop(EventLoop.scala:84)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$stop$3(DAGScheduler.scala:2973)
	at org.apache.spark.util.Utils$.tryLogNonFatalError(Utils.scala:1375)
	at org.apache.spark.scheduler.DAGScheduler.stop(DAGScheduler.scala:2973)
	at org.apache.spark.SparkContext.$anonfun$stop$12(SparkContext.scala:2258)
	at org.apache.spark.util.Utils$.tryLogNonFatalError(Utils.scala:1375)
	at org.apache.spark.SparkContext.stop(SparkContext.scala:2258)
	at org.apache.spark.SparkContext.stop(SparkContext.scala:2211)
	at org.apache.spark.SparkContext.$anonfun$new$34(SparkContext.scala:681)
	at org.apache.spark.util.SparkShutdownHook.run(ShutdownHookManager.scala:214)
	at org.apache.spark.util.SparkShutdownHookManager.$anonfun$runAll$2(ShutdownHookManager.scala:188)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)
	at org.apache.spark.util.SparkShutdownHookManager.$anonfun$runAll$1(ShutdownHookManager.scala:188)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at scala.util.Try$.apply(Try.scala:213)
	at org.apache.spark.util.SparkShutdownHookManager.runAll(ShutdownHookManager.scala:188)
	at org.apache.spark.util.SparkShutdownHookManager$$anon$2.run(ShutdownHookManager.scala:178)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.sql.delta.files.DeltaFileFormatWriter$.$anonfun$executeWrite$1(DeltaFileFormatWriter.scala:267)
	at org.apache.spark.sql.delta.files.DeltaFileFormatWriter$.writeAndCommit(DeltaFileFormatWriter.scala:300)
	at org.apache.spark.sql.delta.files.DeltaFileFormatWriter$.executeWrite(DeltaFileFormatWriter.scala:236)
	at org.apache.spark.sql.delta.files.DeltaFileFormatWriter$.write(DeltaFileFormatWriter.scala:216)
	at org.apache.spark.sql.delta.files.TransactionalWrite.$anonfun$writeFiles$2(TransactionalWrite.scala:456)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.delta.files.TransactionalWrite.writeFiles(TransactionalWrite.scala:414)
	at org.apache.spark.sql.delta.files.TransactionalWrite.writeFiles$(TransactionalWrite.scala:372)
	at org.apache.spark.sql.delta.OptimisticTransaction.writeFiles(OptimisticTransaction.scala:165)
	at org.apache.spark.sql.delta.files.TransactionalWrite.writeFiles(TransactionalWrite.scala:247)
	at org.apache.spark.sql.delta.files.TransactionalWrite.writeFiles$(TransactionalWrite.scala:243)
	at org.apache.spark.sql.delta.OptimisticTransaction.writeFiles(OptimisticTransaction.scala:165)
	at org.apache.spark.sql.delta.files.TransactionalWrite.writeFiles(TransactionalWrite.scala:236)
	at org.apache.spark.sql.delta.files.TransactionalWrite.writeFiles$(TransactionalWrite.scala:233)
	at org.apache.spark.sql.delta.OptimisticTransaction.writeFiles(OptimisticTransaction.scala:165)
	at org.apache.spark.sql.delta.sources.DeltaSink.$anonfun$addBatchWithStatusImpl$4(DeltaSink.scala:151)
	at org.apache.spark.util.Utils$.timeTakenMs(Utils.scala:552)
	at org.apache.spark.sql.delta.sources.DeltaSink.addBatchWithStatusImpl(DeltaSink.scala:151)
	at org.apache.spark.sql.delta.sources.DeltaSink.addBatch(DeltaSink.scala:104)
	at org.apache.spark.sql.execution.streaming.MicroBatchExecution.$anonfun$runBatch$17(MicroBatchExecution.scala:732)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.execution.streaming.MicroBatchExecution.$anonfun$runBatch$16(MicroBatchExecution.scala:729)
	at org.apache.spark.sql.execution.streaming.ProgressReporter.reportTimeTaken(ProgressReporter.scala:427)
	at org.apache.spark.sql.execution.streaming.ProgressReporter.reportTimeTaken$(ProgressReporter.scala:425)
	at org.apache.spark.sql.execution.streaming.StreamExecution.reportTimeTaken(StreamExecution.scala:67)
	at org.apache.spark.sql.execution.streaming.MicroBatchExecution.runBatch(MicroBatchExecution.scala:729)
	at org.apache.spark.sql.execution.streaming.MicroBatchExecution.$anonfun$runActivatedStream$2(MicroBatchExecution.scala:286)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at org.apache.spark.sql.execution.streaming.ProgressReporter.reportTimeTaken(ProgressReporter.scala:427)
	at org.apache.spark.sql.execution.streaming.ProgressReporter.reportTimeTaken$(ProgressReporter.scala:425)
	at org.apache.spark.sql.execution.streaming.StreamExecution.reportTimeTaken(StreamExecution.scala:67)
	at org.apache.spark.sql.execution.streaming.MicroBatchExecution.$anonfun$runActivatedStream$1(MicroBatchExecution.scala:249)
	at org.apache.spark.sql.execution.streaming.ProcessingTimeExecutor.execute(TriggerExecutor.scala:67)
	at org.apache.spark.sql.execution.streaming.MicroBatchExecution.runActivatedStream(MicroBatchExecution.scala:239)
	at org.apache.spark.sql.execution.streaming.StreamExecution.$anonfun$runStream$1(StreamExecution.scala:311)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.streaming.StreamExecution.org$apache$spark$sql$execution$streaming$StreamExecution$$runStream(StreamExecution.scala:289)
	at org.apache.spark.sql.execution.streaming.StreamExecution$$anon$1.$anonfun$run$1(StreamExecution.scala:211)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at org.apache.spark.JobArtifactSet$.withActiveJobArtifactState(JobArtifactSet.scala:94)
	at org.apache.spark.sql.execution.streaming.StreamExecution$$anon$1.run(StreamExecution.scala:211)
26/01/01 18:19:07 ERROR MicroBatchExecution: Query [id = ee76ee46-ae2c-45fa-a526-a826154fdfb7, runId = f174d2d0-54d4-41e5-b4a5-8826c3e31e18] terminated with error
org.apache.spark.SparkException: Job 266 cancelled because SparkContext was shut down
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$cleanUpAfterSchedulerStop$1(DAGScheduler.scala:1253)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$cleanUpAfterSchedulerStop$1$adapted(DAGScheduler.scala:1251)
	at scala.collection.mutable.HashSet.foreach(HashSet.scala:79)
	at org.apache.spark.scheduler.DAGScheduler.cleanUpAfterSchedulerStop(DAGScheduler.scala:1251)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onStop(DAGScheduler.scala:3087)
	at org.apache.spark.util.EventLoop.stop(EventLoop.scala:84)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$stop$3(DAGScheduler.scala:2973)
	at org.apache.spark.util.Utils$.tryLogNonFatalError(Utils.scala:1375)
	at org.apache.spark.scheduler.DAGScheduler.stop(DAGScheduler.scala:2973)
	at org.apache.spark.SparkContext.$anonfun$stop$12(SparkContext.scala:2258)
	at org.apache.spark.util.Utils$.tryLogNonFatalError(Utils.scala:1375)
	at org.apache.spark.SparkContext.stop(SparkContext.scala:2258)
	at org.apache.spark.SparkContext.stop(SparkContext.scala:2211)
	at org.apache.spark.SparkContext.$anonfun$new$34(SparkContext.scala:681)
	at org.apache.spark.util.SparkShutdownHook.run(ShutdownHookManager.scala:214)
	at org.apache.spark.util.SparkShutdownHookManager.$anonfun$runAll$2(ShutdownHookManager.scala:188)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)
	at org.apache.spark.util.SparkShutdownHookManager.$anonfun$runAll$1(ShutdownHookManager.scala:188)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at scala.util.Try$.apply(Try.scala:213)
	at org.apache.spark.util.SparkShutdownHookManager.runAll(ShutdownHookManager.scala:188)
	at org.apache.spark.util.SparkShutdownHookManager$$anon$2.run(ShutdownHookManager.scala:178)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.sql.delta.files.DeltaFileFormatWriter$.$anonfun$executeWrite$1(DeltaFileFormatWriter.scala:267)
	at org.apache.spark.sql.delta.files.DeltaFileFormatWriter$.writeAndCommit(DeltaFileFormatWriter.scala:300)
	at org.apache.spark.sql.delta.files.DeltaFileFormatWriter$.executeWrite(DeltaFileFormatWriter.scala:236)
	at org.apache.spark.sql.delta.files.DeltaFileFormatWriter$.write(DeltaFileFormatWriter.scala:216)
	at org.apache.spark.sql.delta.files.TransactionalWrite.$anonfun$writeFiles$2(TransactionalWrite.scala:456)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.delta.files.TransactionalWrite.writeFiles(TransactionalWrite.scala:414)
	at org.apache.spark.sql.delta.files.TransactionalWrite.writeFiles$(TransactionalWrite.scala:372)
	at org.apache.spark.sql.delta.OptimisticTransaction.writeFiles(OptimisticTransaction.scala:165)
	at org.apache.spark.sql.delta.files.TransactionalWrite.writeFiles(TransactionalWrite.scala:247)
	at org.apache.spark.sql.delta.files.TransactionalWrite.writeFiles$(TransactionalWrite.scala:243)
	at org.apache.spark.sql.delta.OptimisticTransaction.writeFiles(OptimisticTransaction.scala:165)
	at org.apache.spark.sql.delta.files.TransactionalWrite.writeFiles(TransactionalWrite.scala:236)
	at org.apache.spark.sql.delta.files.TransactionalWrite.writeFiles$(TransactionalWrite.scala:233)
	at org.apache.spark.sql.delta.OptimisticTransaction.writeFiles(OptimisticTransaction.scala:165)
	at org.apache.spark.sql.delta.sources.DeltaSink.$anonfun$addBatchWithStatusImpl$4(DeltaSink.scala:151)
	at org.apache.spark.util.Utils$.timeTakenMs(Utils.scala:552)
	at org.apache.spark.sql.delta.sources.DeltaSink.addBatchWithStatusImpl(DeltaSink.scala:151)
	at org.apache.spark.sql.delta.sources.DeltaSink.addBatch(DeltaSink.scala:104)
	at org.apache.spark.sql.execution.streaming.MicroBatchExecution.$anonfun$runBatch$17(MicroBatchExecution.scala:732)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.execution.streaming.MicroBatchExecution.$anonfun$runBatch$16(MicroBatchExecution.scala:729)
	at org.apache.spark.sql.execution.streaming.ProgressReporter.reportTimeTaken(ProgressReporter.scala:427)
	at org.apache.spark.sql.execution.streaming.ProgressReporter.reportTimeTaken$(ProgressReporter.scala:425)
	at org.apache.spark.sql.execution.streaming.StreamExecution.reportTimeTaken(StreamExecution.scala:67)
	at org.apache.spark.sql.execution.streaming.MicroBatchExecution.runBatch(MicroBatchExecution.scala:729)
	at org.apache.spark.sql.execution.streaming.MicroBatchExecution.$anonfun$runActivatedStream$2(MicroBatchExecution.scala:286)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at org.apache.spark.sql.execution.streaming.ProgressReporter.reportTimeTaken(ProgressReporter.scala:427)
	at org.apache.spark.sql.execution.streaming.ProgressReporter.reportTimeTaken$(ProgressReporter.scala:425)
	at org.apache.spark.sql.execution.streaming.StreamExecution.reportTimeTaken(StreamExecution.scala:67)
	at org.apache.spark.sql.execution.streaming.MicroBatchExecution.$anonfun$runActivatedStream$1(MicroBatchExecution.scala:249)
	at org.apache.spark.sql.execution.streaming.ProcessingTimeExecutor.execute(TriggerExecutor.scala:67)
	at org.apache.spark.sql.execution.streaming.MicroBatchExecution.runActivatedStream(MicroBatchExecution.scala:239)
	at org.apache.spark.sql.execution.streaming.StreamExecution.$anonfun$runStream$1(StreamExecution.scala:311)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.streaming.StreamExecution.org$apache$spark$sql$execution$streaming$StreamExecution$$runStream(StreamExecution.scala:289)
	at org.apache.spark.sql.execution.streaming.StreamExecution$$anon$1.$anonfun$run$1(StreamExecution.scala:211)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at org.apache.spark.JobArtifactSet$.withActiveJobArtifactState(JobArtifactSet.scala:94)
	at org.apache.spark.sql.execution.streaming.StreamExecution$$anon$1.run(StreamExecution.scala:211)
26/01/01 18:19:07 WARN NettyRpcEnv: Ignored failure: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask@50f41e53[Not completed, task = java.util.concurrent.Executors$RunnableAdapter@3adafe96[Wrapped task = org.apache.spark.rpc.netty.NettyRpcEnv$$anon$1@4b038b7]] rejected from java.util.concurrent.ScheduledThreadPoolExecutor@456a3b6a[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
Exception in thread "stream execution thread for [id = ee76ee46-ae2c-45fa-a526-a826154fdfb7, runId = f174d2d0-54d4-41e5-b4a5-8826c3e31e18]" org.apache.spark.SparkException: Exception thrown in awaitResult: 
	at org.apache.spark.util.SparkThreadUtils$.awaitResult(SparkThreadUtils.scala:56)
	at org.apache.spark.util.ThreadUtils$.awaitResult(ThreadUtils.scala:310)
	at org.apache.spark.rpc.RpcTimeout.awaitResult(RpcTimeout.scala:75)
	at org.apache.spark.rpc.RpcEndpointRef.askSync(RpcEndpointRef.scala:101)
	at org.apache.spark.rpc.RpcEndpointRef.askSync(RpcEndpointRef.scala:85)
	at org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef.deactivateInstances(StateStoreCoordinator.scala:119)
	at org.apache.spark.sql.streaming.StreamingQueryManager.notifyQueryTermination(StreamingQueryManager.scala:426)
	at org.apache.spark.sql.execution.streaming.StreamExecution.$anonfun$runStream$3(StreamExecution.scala:360)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at org.apache.spark.util.UninterruptibleThread.runUninterruptibly(UninterruptibleThread.scala:77)
	at org.apache.spark.sql.execution.streaming.StreamExecution.org$apache$spark$sql$execution$streaming$StreamExecution$$runStream(StreamExecution.scala:340)
	at org.apache.spark.sql.execution.streaming.StreamExecution$$anon$1.$anonfun$run$1(StreamExecution.scala:211)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at org.apache.spark.JobArtifactSet$.withActiveJobArtifactState(JobArtifactSet.scala:94)
	at org.apache.spark.sql.execution.streaming.StreamExecution$$anon$1.run(StreamExecution.scala:211)
Caused by: org.apache.spark.rpc.RpcEnvStoppedException: RpcEnv already stopped.
	at org.apache.spark.rpc.netty.Dispatcher.postMessage(Dispatcher.scala:176)
	at org.apache.spark.rpc.netty.Dispatcher.postLocalMessage(Dispatcher.scala:144)
	at org.apache.spark.rpc.netty.NettyRpcEnv.askAbortable(NettyRpcEnv.scala:242)
	at org.apache.spark.rpc.netty.NettyRpcEndpointRef.askAbortable(NettyRpcEnv.scala:554)
	at org.apache.spark.rpc.netty.NettyRpcEndpointRef.ask(NettyRpcEnv.scala:558)
	at org.apache.spark.rpc.RpcEndpointRef.askSync(RpcEndpointRef.scala:100)
	... 11 more
